webpackJsonp([17],{"6D9J":function(e,t){},DOAq:function(e,t,s){"use strict";(function(e){var a=s("Dd8w"),i=s.n(a),n=s("XLwt"),r=s.n(n),o=s("NYxO");t.a={name:"",data:function(){return{vals:{timer:"",echart:"",option:"",START:"",NOW:"",END:"",FLUSH:""},selectIndex:"1",TIMEOK:!1,isJoinContest:!1,isNeedPassword:!0,activeName:"home",time:"",home:{title:"比赛1",password:"",visible:!0,tableData:[]},problem:{visible:!1,tableData:[],page:{currentPage:1,pageSize:1,total:1}},submit:{visible:!1,tableData:[],page:{currentPage:1,pageSize:1,total:1}},rank:{switch:!1,dialogVisible:!1,visible:!1,total:10,names:[],params:{"":"background-color:white;",AC:"background-color:#dff0d8;",WA:"background-color:#f2dede;",FB:"background-color:#5ecd99;"},tableData:[{userName:"a568283992",ac:2,useTime:"00:00:00",problemTitle:"",problems:[]}],page:{currentPage:1,pageSize:1,total:1}},choose:{AC:"",Pending:"info",Compiling:"info",Judging:"info",WA:"danger",SE:"danger",CE:"danger",RE:"danger",TLE:"danger",MLE:"danger"}}},methods:{triggerRank:function(e){if(e){var t=this.getRank;this.vals.FLUSH=setInterval(t,5e3)}else clearInterval(this.vals.FLUSH)},drawData:function(e){},sortData:function(e){var t=this.convertReverse;e.sort(function(e,s){return e.ac==s.ac?t(e.useTime)>t(s.useTime)?1:-1:s.ac-e.ac}),this.drawData(e)},setRank:function(e){this.rank.total=e.total;for(var t=e.user,s=this.rank.tableData=[],a=0;a<t.length;a++){var i=0,n=0,r=0,o=t[a].contestProblemList;this.rank.names.push(o[a].problemTitle);for(var l={userName:t[a].userName,ac:"",submit_total:"",useTime:"",problems:[]},c=0;c<o.length;c++){var u={time:"",type:""};if(r+=o[c].submitTotal,"AC"==o[c].result){n++;var m=new Date(o[c].submitDate.replace(/-/g,"/")).getTime();u.time=this.convertTo(m-this.vals.START),u.type="AC";var p=o[c].submitTotal-o[c].acCount;p>0&&(u.time+="<br/>(-"+p+")")}else{if(0!=o[c].submitTotal)u.type="WA",i+=9e5*o[c].submitTotal,u.time="(-"+o[c].submitTotal+")"}l.problems.push(u)}l.ac=n,l.useTime=this.convertTo(this.vals.NOW-this.vals.START+i),l.submit_total=r,s.push(l)}this.sortData(s)},getRank:function(){var t=this;e.ajax({type:"post",xhrFields:{withCredentials:this.$CORS},crossDomain:this.$CORS,async:!0,url:"http://"+this.$HOST+"/userPrivate"+this.$route.path+"/rank",dataType:"json",success:function(e){null!=e.success?(t.setRank(e),null!=document.getElementById("main")&&t.initChart()):null!=e.error&&t.$message({type:"error",showClose:!0,message:e.error})},error:function(e){t.$message({type:"error",showClose:!0,message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})},handleSubmitChange:function(){this.getSubmit()},getSubmit:function(){var t=this;e.ajax({type:"post",xhrFields:{withCredentials:this.$CORS},crossDomain:this.$CORS,async:!0,url:"http://"+this.$HOST+"/userPrivate"+this.$route.path+"/submit",data:{page:this.submit.page.currentPage},dataType:"json",success:function(e){null!=e.success?(t.submit.tableData=e.submitList,t.submit.page=e.pagination):null!=e.error&&t.$message({type:"error",showClose:!0,message:e.error})},error:function(e){t.$message({type:"error",showClose:!0,message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})},handleProblemChange:function(){this.getProblem()},getProblem:function(){var t=this;e.ajax({type:"post",xhrFields:{withCredentials:this.$CORS},crossDomain:this.$CORS,async:!0,url:"http://"+this.$HOST+"/userPrivate"+this.$route.path+"/problem",data:{page:this.problem.page.currentPage},dataType:"json",success:function(e){null!=e.success?(t.problem.tableData=[],t.problem.tableData=e.problemList,t.problem.page=e.pagination):null!=e.error&&t.$message({type:"error",showClose:!0,message:e.error})},error:function(e){t.$message({type:"error",showClose:!0,message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})},handleSelect:function(e){for(var t=[this.home,this.problem,this.submit,this.rank],s=0;s<t.length;s++)t[s].visible=!1;t[e-1].visible=!0,1==e?this.verifyContest():2==e?this.getProblem():3==e?this.getSubmit():4==e&&this.getRank()},ajaxJoin:function(){var t=this,s=this.home.password;e.ajax({type:"post",xhrFields:{withCredentials:this.$CORS},crossDomain:this.$CORS,async:!0,url:"http://"+this.$HOST+"/userPrivate"+this.$route.path+"/join",data:{password:s},dataType:"json",success:function(e){null!=e.success?(t.isJoinContest=!0,t.isNeedPassword=!1,t.setTimer(),t.$message({type:"success",showClose:!0,message:e.success})):null!=e.error&&t.$message({type:"error",showClose:!0,message:e.error})},error:function(e){t.$message({type:"error",showClose:!0,message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})},joinContest:function(){var e=this;this.$confirm("是否确定参加此比赛?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.ajaxJoin()}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},convertReverse:function(e){var t=e.split(":");return 1e3*(3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2]))},convertTo:function(e){return e/=1e3,parseInt(e/3600)+":"+parseInt(e%3600/60)+":"+parseInt(e%3600%60)},setTimeFunc:function(){var e=this;e.vals.START=new Date(e.home.tableData[0].startTime.replace(/-/g,"/")).getTime(),e.vals.END=new Date(e.home.tableData[0].endTime.replace(/-/g,"/")).getTime(),e.vals.NOW=(new Date).getTime(),e.vals.END-e.vals.NOW<0?(clearInterval(e.vals.timer),e.time="比赛已经结束",e.TIMEOK=!1):e.vals.NOW>=e.vals.START?(e.time="比赛进行中,离结束还有 [ "+e.convertTo(e.vals.END-e.vals.NOW)+" ] ",e.TIMEOK=!0):(e.time="比赛还没开始,离比赛开始还有 [ "+e.convertTo(e.vals.START-e.vals.NOW)+" ] ",e.TIMEOK=!1)},setTimer:function(){this.setTimeFunc(),this.vals.timer=setInterval(this.setTimeFunc,500)},verifyContest:function(){var t=this;e.ajax({type:"get",xhrFields:{withCredentials:this.$CORS},crossDomain:this.$CORS,async:!1,url:"http://"+this.$HOST+"/userPrivate"+this.$route.path+"/verify",dataType:"json",success:function(e){null!=e.success?t.setResult(e):null!=e.error&&(t.$message({type:"error",message:e.error}),t.$router.go(-1))},error:function(e){t.$message({type:"error",showClose:!0,message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})},setResult:function(e){if(null!=e.contest){this.home.title=e.contest.contestName,this.home.description=e.contest.contestDescription;var t={startTime:e.contest.startTime,endTime:e.contest.endTime,contestType:"",creator:e.contest.contestCreator};e.showPassword?(this.isNeedPassword=!0,t.contestType="需要密码"):(this.isNeedPassword=!1,t.contestType="没有密码"),this.home.tableData=[],this.home.tableData.push(t),this.isJoinContest=e.isJoinContest,e.isJoinContest&&(this.isNeedPassword=!1),1!=this.user.userGrant&&this.isNeedPassword&&!this.isJoinContest||this.setTimer()}},setChart:function(){for(var e=this.rank,t=e.tableData.length<10?e.tableData.length:10,s=[],a=[],i=[],n=[],r=-1,o=1;o<=t;o++)s.push(o),a.push(e.tableData[o-1].ac),i.push(e.tableData[o-1].submit_total),n.push(e.tableData[o-1].userName),e.tableData[o-1].submit_total>r&&(r=e.tableData[o-1].submit_total);r=10*(parseInt(r/10)+1),this.vals.option.xAxis.data=s,this.vals.option.yAxis[0].max=t,this.vals.option.yAxis[1].max=r,this.vals.option.series[0].data=a,this.vals.option.series[1].data=i,this.vals.echart.setOption(this.vals.option)},initChart:function(){var e=this;e.vals.echart=r.a.init(document.getElementById("main")),e.vals.option={color:["#419dfc","#c23731"],tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:["已AC题数","提交次数"]},xAxis:{type:"category",data:[],axisPointer:{label:{formatter:function(t){return"名称："+e.rank.tableData[t.value-1].userName}},type:"shadow"}},yAxis:[{type:"value",name:"题数",min:0,max:10,interval:1,axisLabel:{formatter:"{value}个"}},{type:"value",name:"提交",min:0,max:500,interval:50,axisLabel:{formatter:"{value}次"}}],series:[{name:"已AC题数",data:[],yAxisIndex:0,type:"line"},{name:"提交次数",data:[],yAxisIndex:1,type:"bar"}]},this.setChart()}},computed:i()({},Object(o.c)(["user"])),mounted:function(){this.verifyContest(),this.isJoinContest&&this.TIMEOK&&(this.selectIndex="2",this.handleSelect(2)),console.log(this.isJoinContest,this.TIMEOK)},watch:{$route:function(e,t){this.verifyContest()}}}}).call(t,s("7t+N"))},noee:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("DOAq"),i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"rightContestView"},[s("el-row",[s("el-menu",{attrs:{"default-active":e.selectIndex,mode:"horizontal"},on:{select:e.handleSelect}},[s("el-menu-item",{attrs:{index:"1"}},[s("i",{staticClass:"iconfont icon-zhuye1"}),s("span",{staticClass:"font"},[e._v(" 主页")])]),e._v(" "),s("el-menu-item",{attrs:{index:"2",disabled:!(e.isJoinContest&&e.TIMEOK||1==e.user.userGrant)}},[s("i",{staticClass:"iconfont icon-liebiao2"}),s("span",{staticClass:"font"},[e._v(" 题目")])]),e._v(" "),s("el-menu-item",{attrs:{index:"3",disabled:!(e.isJoinContest&&e.TIMEOK||1==e.user.userGrant)}},[s("i",{staticClass:"iconfont icon-liebiao"}),s("span",{staticClass:"font"},[e._v(" 提交")])]),e._v(" "),s("el-menu-item",{attrs:{index:"4",disabled:!(e.isJoinContest&&e.TIMEOK||1==e.user.userGrant)}},[s("i",{staticClass:"iconfont icon-tubiao"}),s("span",{staticClass:"font"},[e._v(" 排名")])])],1)],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.home.visible,expression:"home.visible"}],staticClass:"common"},[s("h2",{staticStyle:{"margin-left":"10px","margin-top":"20px",color:"#303133"}},[e._v(e._s(e.home.title))]),e._v(" "),s("br"),e._v(" "),s("div",{staticStyle:{"margin-left":"10px","margin-top":"20px"},domProps:{innerHTML:e._s(e.home.description)}}),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("el-row",[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.home.tableData,stripe:""}},[s("el-table-column",{attrs:{align:"left","header-align":"left",prop:"startTime",label:"开始时间",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",prop:"endTime",label:"结束时间",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"比赛类型",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.contestType)+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",prop:"creator",label:"比赛创建者",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-row",[s("el-tag",{directives:[{name:"show",rawName:"v-show",value:!e.isNeedPassword||e.isNeedPassword&&e.isJoinContest||1==e.user.userGrant,expression:"!isNeedPassword || (isNeedPassword && isJoinContest) || user.userGrant == 1"}]},[e._v(e._s(e.time))]),e._v(" "),s("el-col",{directives:[{name:"show",rawName:"v-show",value:!(1==e.user.userGrant||!e.isNeedPassword||e.isJoinContest),expression:"!(user.userGrant == 1 || !isNeedPassword || isJoinContest) "}],attrs:{span:16}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.home.password,callback:function(t){e.$set(e.home,"password",t)},expression:"home.password"}})],1),e._v("\n                 \n                "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!(e.isJoinContest||1==e.user.userGrant),expression:"!(isJoinContest || user.userGrant == 1)"}],attrs:{type:"primary",icon:"el-icon-check",circle:""},on:{click:e.joinContest}},[e._v("参加")])],1)]}}])})],1)],1)],1)]),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.problem.visible,expression:"problem.visible"}],staticClass:"common"},[s("h2",{staticStyle:{"margin-left":"10px","margin-top":"20px",color:"#303133"}},[e._v("题目")]),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("div",[s("el-table",{staticClass:"problem",staticStyle:{width:"100%"},attrs:{data:e.problem.tableData}},[s("el-table-column",{attrs:{align:"left","header-align":"left",label:"#"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(String.fromCharCode((e.problem.page.currentPage-1)*e.problem.page.pageSize+t.$index+65))+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"题目"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("router-link",{attrs:{to:"/contest/"+e.$route.params.id+"/coding/"+t.row.problemId}},[e._v(e._s(t.row.problemTitle))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"总提交数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.submitTotal)+"\n            ")]}}])})],1)],1),e._v(" "),s("div",{staticClass:"block pull-right"},[s("el-pagination",{attrs:{background:"","current-page":e.problem.page.currentPage,"page-size":e.problem.page.pageSize,layout:"prev, pager, next, jumper",total:e.problem.page.total},on:{"current-change":e.handleProblemChange,"update:currentPage":function(t){e.$set(e.problem.page,"currentPage",t)}}})],1)])]),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.submit.visible,expression:"submit.visible"}],staticClass:"common"},[s("h2",{staticStyle:{"margin-left":"10px","margin-top":"20px",color:"#303133"}},[e._v("提交")]),e._v(" "),s("div",{staticStyle:{"margin-top":"20px"}},[s("div",[s("el-table",{staticClass:"submit",staticStyle:{width:"100%"},attrs:{data:e.submit.tableData}},[s("el-table-column",{attrs:{align:"left","header-align":"left",label:"#"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("router-link",{attrs:{to:"/contest/"+e.$route.params.id+"/submit/"+t.row.id}},[e._v(e._s(t.row.id))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"提交时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.submitDate)+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.userName)+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"题目"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("router-link",{attrs:{to:"/contest/"+e.$route.params.id+"/coding/"+t.row.problemId}},[e._v(e._s(t.row.problemTitle))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"测评结果"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:e.choose[t.row.result]}},[e._v(e._s(t.row.result))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"cpu时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.cpuTime)+"ms\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"内存"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.memorySize)+"KB\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"left","header-align":"left",label:"语言"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",[e._v(e._s(t.row.language))])]}}])})],1)],1),e._v(" "),s("div",{staticClass:"block pull-right"},[s("el-pagination",{attrs:{background:"","current-page":e.submit.page.currentPage,"page-size":e.submit.page.pageSize,layout:"prev, pager, next, jumper",total:e.submit.page.total},on:{"current-change":e.handleSubmitChange,"update:currentPage":function(t){e.$set(e.submit.page,"currentPage",t)}}})],1)])]),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.rank.visible,expression:"rank.visible"}],staticClass:"common"},[s("h2",{staticStyle:{"margin-left":"10px","margin-top":"20px",color:"#303133"}},[e._v("排名")]),e._v(" "),s("el-row",{staticStyle:{"margin-bottom":"20px"}},[s("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:2,offset:18}},[s("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            开启自动刷新？(5s)\n          ")]),e._v(" "),s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.triggerRank},model:{value:e.rank.switch,callback:function(t){e.$set(e.rank,"switch",t)},expression:"rank.switch"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-button",{on:{click:function(t){e.getRank(),e.rank.dialogVisible=!0}}},[e._v("打开rank图表信息")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"rank图表信息",visible:e.rank.dialogVisible,width:"80%"},on:{"update:visible":function(t){e.$set(e.rank,"dialogVisible",t)}}},[s("div",{staticStyle:{"margin-top":"20px",height:"400px"}},[s("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"main"}})])]),e._v(" "),s("el-row",[s("table",{staticClass:"table"},[s("thead",[s("tr",{staticClass:"head"},[s("th",{staticStyle:{width:"30px"}},[e._v("#")]),e._v(" "),s("th",[e._v("名称")]),e._v(" "),s("th",[e._v("通过/总数")]),e._v(" "),s("th",[e._v("总时间")]),e._v(" "),e._l(e.rank.total,function(t){return s("th",[s("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                  题目："+e._s(e.rank.names[t-1])+"\n                ")]),e._v(" "),s("div",[e._v("\n                  "+e._s(String.fromCharCode(65+t-1))+"\n                ")])])],1)})],2)]),e._v(" "),s("tbody",e._l(e.rank.tableData,function(t,a){return s("tr",{staticClass:"body"},[s("td",[e._v(e._s(a+1))]),e._v(" "),s("td",[e._v(e._s(t.userName))]),e._v(" "),s("td",[e._v(e._s(t.ac)+"/"+e._s(e.rank.total))]),e._v(" "),s("td",{},[e._v(e._s(t.useTime))]),e._v(" "),e._l(t.problems,function(t,a){return s("td",{style:e.rank.params[t.type],domProps:{innerHTML:e._s(t.time)}})})],2)}))])])],1)],1)},staticRenderFns:[]};var n=function(e){s("6D9J")},r=s("VU/8")(a.a,i,!1,n,null,null);t.default=r.exports}});