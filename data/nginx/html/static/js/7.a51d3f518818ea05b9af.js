webpackJsonp([7],{IEKw:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("mruL"),i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"rightNoticeConfig"},[o("el-row",[o("el-row",{staticClass:"head"},[o("el-col",{attrs:{span:4}},[o("div",{staticClass:"title"},[o("span",[e._v(e._s(e.title))])])]),e._v(" "),o("el-col",{staticClass:"search-btn",attrs:{span:3,offset:17}},[o("el-button",{staticStyle:{width:"120px"},attrs:{size:"medium",icon:"search"},on:{click:function(t){e.noticeForm.active=!0}}},[o("i",{staticClass:"el-icon-plus"}),e._v("添加")])],1),e._v(" "),o("div",{staticStyle:{position:"relative",top:"10px","margin-right":"10px"}},[o("el-dialog",{attrs:{title:"添加公告",visible:e.noticeForm.active,"close-on-click-modal":!1,width:"70%"},on:{"update:visible":function(t){e.$set(e.noticeForm,"active",t)}}},[o("el-form",{ref:"noticeForm",attrs:{"status-icon":"",rules:e.noticeRule,model:e.noticeForm}},[o("el-row",[o("el-form-item",{attrs:{label:"标题",prop:"title"}},[o("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.noticeForm.title,callback:function(t){e.$set(e.noticeForm,"title",t)},expression:"noticeForm.title"}})],1)],1),e._v(" "),o("el-row",[o("p",{staticStyle:{"font-size":"14px"}},[e._v("内容")]),e._v(" "),o("br"),e._v(" "),o("quill-editor",{ref:"noticeText",attrs:{options:e.editorOption},on:{change:function(t){e.noticeFormChange(t)}},model:{value:e.noticeForm.content,callback:function(t){e.$set(e.noticeForm,"content",t)},expression:"noticeForm.content"}})],1),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("br"),e._v(" "),o("el-row",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("noticeForm")}}},[e._v("提交")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetForm("noticeForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"编辑公告",visible:e.updateForm.active,"close-on-click-modal":!1,width:"70%"},on:{"update:visible":function(t){e.$set(e.updateForm,"active",t)}}},[o("el-form",{ref:"updateForm",attrs:{"status-icon":"",rules:e.noticeRule,model:e.updateForm}},[o("el-row",[o("el-form-item",{attrs:{label:"标题",prop:"title"}},[o("el-input",{attrs:{type:"text","auto-complete":"off"},model:{value:e.updateForm.title,callback:function(t){e.$set(e.updateForm,"title",t)},expression:"updateForm.title"}})],1)],1),e._v(" "),o("el-row",[o("p",{staticStyle:{"font-size":"14px"}},[e._v("内容")]),e._v(" "),o("br"),e._v(" "),o("quill-editor",{ref:"updateText",attrs:{options:e.editorOption},on:{change:function(t){e.updateFormChange(t)}},model:{value:e.updateForm.content,callback:function(t){e.$set(e.updateForm,"content",t)},expression:"updateForm.content"}})],1),e._v(" "),o("br"),e._v(" "),o("el-row",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("updateForm")}}},[e._v("提交")]),e._v(" "),o("el-button",{on:{click:function(t){e.resetForm("updateForm")}}},[e._v("重置")])],1)],1)],1)],1)],1),e._v(" "),o("el-row",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.noticeTable,"empty-text":"NO DATA"}},[o("el-table-column",{attrs:{align:"left","header-align":"left",fixed:"",prop:"noticeId",label:"ID",sortable:"",width:"100"}}),e._v(" "),o("el-table-column",{attrs:{align:"left","header-align":"left",prop:"title",label:"标题",width:"180"}}),e._v(" "),o("el-table-column",{attrs:{align:"left","header-align":"left",prop:"createTime",label:"创建时间",width:"160"}}),e._v(" "),o("el-table-column",{attrs:{align:"left","header-align":"left",prop:"currentUpdateTime",label:"最后更新时间",width:"160"}}),e._v(" "),o("el-table-column",{attrs:{align:"left","header-align":"left",prop:"createUserName",label:"作者",width:"150"}}),e._v(" "),o("el-table-column",{attrs:{align:"left","header-align":"left",label:"是否可见",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(o){e.switchChange(e.noticeTable,t.$index,t.row.isShow)}},model:{value:t.row.isShow,callback:function(o){e.$set(t.row,"isShow",o)},expression:"scope.row.isShow"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"left","header-align":"left",fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticStyle:{padding:"8px 15px"},attrs:{icon:"el-icon-edit",size:"small"},nativeOn:{click:function(o){o.preventDefault(),e.edit(t.row.noticeId,t.row.title,t.row.content)}}},[e._v("\n              编辑\n            ")]),e._v(" "),o("br"),e._v(" "),o("el-button",{staticStyle:{padding:"8px 15px"},attrs:{icon:"el-icon-delete",size:"small"},nativeOn:{click:function(o){o.preventDefault(),e.deleteRow(t.row.noticeId)}}},[e._v("\n              删除\n            ")])]}}])})],1)],1),e._v(" "),o("div",{staticClass:"block pull-right"},[o("el-pagination",{attrs:{background:"","current-page":e.page.currentPage,"page-size":e.page.pageSize,layout:"prev, pager, next, jumper",total:e.page.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.page,"currentPage",t)}}})],1)],1)],1)},staticRenderFns:[]};var s=function(e){o("ZWxF")},a=o("VU/8")(n.a,i,!1,s,null,null);t.default=a.exports},ZWxF:function(e,t){},mruL:function(e,t,o){"use strict";(function(e){var n=o("Dd8w"),i=o.n(n),s=o("NYxO"),a=o("G0J2"),r=(o.n(a),o("GH0r"));a.Quill.register("modules/ImageExtend",r.a),t.a={components:{quillEditor:a.quillEditor},name:"rightNoticeConfig",data:function(){var e=this;return{loading:!0,page:{currentPage:1,pageSize:1,total:1},noticeForm:{active:!1,title:"",content:""},updateForm:{noticeId:"",active:!1,title:"",content:""},noticeRule:{title:[{validator:function(e,t,o){""==t?o(new Error("请输入标题")):t.length>20?o(new Error("标题长度在1-20之间")):o()},trigger:"change"}]},title:"公告管理",editorOption:{modules:{ImageExtend:{loading:!0,name:"img",size:5,action:"http://"+this.$HOST+"/common/upload",response:function(e){return e},sizeError:function(){e.$message({type:"错误",message:"文件大小超过5M"})},error:function(){e.$message({type:"错误",message:"上传失败，可能是服务器出错"})}},toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:[]},{background:[]}],[{align:[]}],["link","image"]],handlers:{image:function(){r.b.emit(this.quill.id)}}}}},noticeTable:[]}},computed:i()({},Object(s.c)(["user"])),mounted:function(){this.setInfo()},watch:{$route:function(e,t){this.setInfo()}},methods:{switchChange:function(t,o,n){var i=this,s=t[o].noticeId;e.ajax({type:"post",xhrFields:{withCredentials:this.$CORS},crossDomain:this.$CORS,async:!0,url:"http://"+this.$HOST+"/backend/changeShowNotice",dataType:"json",data:{noticeId:s,show:n},success:function(e){null!=e.success&&i.$message({type:"success",message:"公告"+s+"状态变为"+(n?"可见":"不可见")})},error:function(e){i.$message({type:"error",message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})},handleCurrentChange:function(e){var t=this.$route.path;t=t.substr(0,t.lastIndexOf("/"))+"/"+e,this.$router.push(t)},returnUrl:function(){return"http://"+this.$HOST+this.$route.path},setInfo:function(){var t=this,o=this.returnUrl();this.noticeTable=[],this.loading=!0,e.ajax({type:"get",xhrFields:{withCredentials:this.$CORS},crossDomain:this.$CORS,async:!0,url:o,dataType:"json",success:function(e){t.page=e.pagination,t.loading=!1,t.noticeTable=e.notices},error:function(e){t.$message({type:"error",message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})},noticeFormChange:function(e){this.noticeForm.content=e.html},updateFormChange:function(e){this.updateForm.content=e.html},submitForm:function(t){var o=this;this.$refs[t].validate(function(n){"noticeForm"==t?n&&e.ajax({type:"post",xhrFields:{withCredentials:o.$CORS},crossDomain:o.$CORS,async:!0,url:"http://"+o.$HOST+"/backend/addNotice",dataType:"json",data:o.noticeForm,success:function(e){null!=e.success?(o.$message({type:"success",message:"添加成功！"}),o.setInfo(),o.noticeForm.active=!1):null!=e.error&&o.$message({type:"error",message:e.error})},error:function(e){o.$message({type:"error",message:null==e.responseJSON?"系统错误":e.responseJSON.message})}}):n&&e.ajax({type:"post",xhrFields:{withCredentials:o.$CORS},crossDomain:o.$CORS,async:!0,url:"http://"+o.$HOST+"/backend/saveNotice",dataType:"json",data:o.updateForm,success:function(e){null!=e.success?(o.$message({type:"success",message:"公告"+o.updateForm.noticeId+"修改成功"}),o.updateForm.active=!1,o.setInfo()):null!=e.error&&o.$message({type:"error",message:e.error})},error:function(e){o.$message({type:"error",message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})})},resetForm:function(e){this.$refs[e].resetFields(),"updateForm"==e?(this.updateForm.title="",this.updateForm.content=""):(this.noticeForm.title="",this.noticeForm.content="")},deleteRow:function(t){var o=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.ajax({type:"post",xhrFields:{withCredentials:o.$CORS},crossDomain:o.$CORS,async:!0,url:"http://"+o.$HOST+"/backend/deleteNotice",dataType:"json",data:{id:t},success:function(e){null!=e.success?(o.$message({type:"success",message:e.success}),o.setInfo()):null!=e.error&&o.$message({type:"error",message:e.error})},error:function(e){o.$message({type:"error",message:null==e.responseJSON?"系统错误":e.responseJSON.message})}})}).catch(function(){o.$message({type:"info",message:"已取消删除"})})},edit:function(e,t,o){this.updateForm.title=t,this.updateForm.content=o,this.updateForm.active=!0,this.updateForm.noticeId=e}}}}).call(t,o("7t+N"))}});