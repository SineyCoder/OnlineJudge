<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jsut.ecoder.dao.BackendMapper">

    <insert id="insertNewProblem" parameterType="problemRecords" keyProperty="problemId" useGeneratedKeys="true">
      INSERT INTO web_problems(problemTitle, problemDescription, problemInputDescription, problemOutputDescription, problemSample, problemDifficulty, problemIsShow, problemType, problemReturn, problemHint, problemSource, problemAuthor, problemCreateTime, problemInput,problemOutput)
      VALUES (#{problemTitle},#{problemDescription},#{problemInputDescription},#{problemOutputDescription},#{problemSample},#{problemDifficulty},#{problemIsShow},#{spj},#{returnErr},#{problemHint},#{problemSource},#{problemAuthor},#{problemCreateTime},#{problemInput},#{problemOutput});
    </insert>

    <select id="selectIdByTagName" resultType="java.lang.Integer">
        SELECT tagId
        FROM web_tag
        WHERE tagName = #{tagname}
    </select>

    <insert id="insertTag" keyProperty="tagId" useGeneratedKeys="true">
        INSERT INTO web_tag(tagName,createTime)
        values(#{tagName},#{createTime})
    </insert>

    <insert id="insertTagProblem">
        INSERT INTO web_problems_tag(tagId,problemId)
        values(#{tagId},#{problemId})
    </insert>

    <!--使用动态sql拼接，实现快速插入-->
    <sql id="value">
        <trim suffixOverrides=")" prefixOverrides="(">
            <foreach collection="list" index="index" item="item" open="(" close=")" separator=",">
                (#{item.problemId},#{item.languageId},#{item.problemMemory},#{item.problemCpuTime})
            </foreach>
        </trim>
    </sql>
    <insert id="insertLanguagesParam" parameterType="java.util.List">
        INSERT INTO web_problems_language(problemId,languageId,problemMemory,problemCpuTime)
        VALUES
        <include refid="value"></include>
    </insert>

</mapper>
